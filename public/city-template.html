<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{title}}</title>
  <meta name="description" content="{{description}}" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="{{title}}" />
  <meta property="og:description" content="{{description}}" />
  <meta property="og:image" content="{{imageUrl}}" />
  <meta property="og:url" content="{{canonicalUrl}}" />
  <meta name="date" content="{{date}}" />
  <link rel="canonical" href="{{canonicalUrl}}" />
  <meta name="robots" content="index,follow" />
  
  <!-- âœ… ê³µí†µ ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="/css/common.css">
  <link rel="stylesheet" href="/css/home.css">
</head>

<body>
  {{HEADER_SEARCH}}

<main style="max-width:900px;margin:60px auto;padding:0 20px;">
  <section class="hotel-section">
    <h2>{{cityName}} ì¸ê¸° ìˆ™ì†Œ</h2>
    <div class="scroll-wrapper">
      <button class="scroll-btn left" data-target="hotelList-top">â€¹</button>
      <div class="horizontal-scroll" id="hotelList-top"></div>
      <button class="scroll-btn right" data-target="hotelList-top">â€º</button>
    </div>
  </section>

  <section class="hotel-section">
    <h2>ê°€ì¡±ê³¼ í•¨ê»˜í•˜ê¸° ì¢‹ì€ ìˆ™ì†Œ</h2>
    <div class="scroll-wrapper">
      <button class="scroll-btn left" data-target="hotelList-family">â€¹</button>
      <div class="horizontal-scroll" id="hotelList-family"></div>
      <button class="scroll-btn right" data-target="hotelList-family">â€º</button>
    </div>
  </section>

  <section class="hotel-section">
    <h2>ë°˜ë ¤ë™ë¬¼ ë™ë°˜ ìˆ™ì†Œ</h2>
    <div class="scroll-wrapper">
      <button class="scroll-btn left" data-target="hotelList-pet">â€¹</button>
      <div class="horizontal-scroll" id="hotelList-pet"></div>
      <button class="scroll-btn right" data-target="hotelList-pet">â€º</button>
    </div>
  </section>
</main>


  <footer>â“’ 2025 RapidStay | Expedia Partner Data ê¸°ë°˜</footer>

  <!-- === JS === -->
  <script type="module">
    import { TARGET_CITIES } from "/js/cities.js";
    window.citySlugMap = Object.fromEntries(
      TARGET_CITIES.map(c => [c.display, c.name.toLowerCase()])
    );
  </script>

<script type="module" src="/js/common.js"></script>

<script type="module">
  import { initSearchBar } from "/js/common.js";
  initSearchBar();
</script>

  <script>
    const city = "{{cityName}}";
    const BASE_PATH = "/";

    document.addEventListener("DOMContentLoaded", () => {
      const slug = window.citySlugMap?.[city] || city.toLowerCase();

      fetch(`${BASE_PATH}city-data/${slug}-top5.json`)
        .then(res => res.json())
        .then(data => {
          renderHotels(data.topRated, "hotelList-top");
          renderHotels(data.family, "hotelList-family");
          renderHotels(data.petFriendly, "hotelList-pet");
        })
        .catch(err => console.error("âŒ í˜¸í…” ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", err));

      document.querySelectorAll(".scroll-btn").forEach(btn => {
        btn.addEventListener("click", () => {
          const target = document.getElementById(btn.dataset.target);
          if (!target) return;
          target.scrollBy({
            left: btn.classList.contains("left") ? -target.clientWidth * 0.9 : target.clientWidth * 0.9,
            behavior: "smooth"
          });
        });
      });
    });

function renderHotels(hotels, targetId) {
  // scroll-wrapper ì•ˆì˜ horizontal-scrollë¥¼ ì°¾ì•„ì•¼ í•¨
  const wrapper = document.getElementById(targetId);
  if (!wrapper) return;

  // wrapperê°€ ì´ë¯¸ horizontal-scrollë¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
  const el = wrapper.classList.contains("horizontal-scroll")
    ? wrapper
    : wrapper.querySelector(".horizontal-scroll");

  if (!el) return;

  if (!hotels?.length) {
    el.innerHTML = "<p style='text-align:center;color:#777;'>í‘œì‹œí•  ìˆ™ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
    return;
  }

  const cards = hotels
    .map(
      (h) => `
        <div class="hotel-card">
          <img src="${h.image || "https://picsum.photos/seed/" + encodeURIComponent(h.name) + "/400/250"}" alt="${h.name}">
          <div class="hotel-info">
            <strong>${h.name}</strong>
            <p>ğŸ“ ${h.address || h.city}</p>
            <p>â­ ${h.rating || "4.5"} / 5.0</p>
          </div>
        </div>`
    )
    .join("");

  // âœ… ê¸°ì¡´ êµ¬ì¡° ìœ ì§€, ì¹´ë“œë§Œ ì£¼ì…
  el.innerHTML = cards;
}

document.addEventListener("click", (e) => {
  const btn = e.target.closest(".scroll-btn");
  if (!btn) return;

  const target = document.getElementById(btn.dataset.target);
  if (!target) return;

  const scroller = target.classList.contains("horizontal-scroll")
    ? target
    : target.querySelector(".horizontal-scroll");

  if (!scroller) return;

  const shift = scroller.clientWidth * 0.9 * (btn.classList.contains("left") ? -1 : 1);
  scroller.scrollBy({ left: shift, behavior: "smooth" });
});


  </script>
</body>
</html>
